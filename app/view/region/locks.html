<% extends "layout/main.html" %>

<% block content %>
<div id="page">
    <template>
    <div class="content">
        <!-- 分类树 -->
        <div class="tree-list">

            <div class="tree-item" id="region.id" v-for="(region,index) in list_region[0]">
                <div class="item">
                    <span class="icon iconfont" :class="getAgentClass(region)"></span>
                    <span>{{ region.name }}</span>
                </div>
                <div class="child-list" v-if="list_region[region.id]">
                    <div class="tree-item">
                        <div class="item active">二级区域</div>
                        <div class="child-list"></div>
                    </div>
                </div>
            </div>

        </div>

        <!-- 数据展示 -->
        <div class="data-page">
        <table>
            <thead>
            <th class="tb-col-1 text-center">锁状态</th>
            <th class="tb-col-5">锁ID</th>
            <th class="tb-col-6">锁名称</th>
            <th class="tb-col-4 text-center">操作</th>
            </thead>
            <tbody>
            <tr>
                <td class="tb-col-1 text-center">开启</td>
                <td class="tb-col-5">534353187482462</td>
                <td class="tb-col-6">艾乐科智能无源碧锁1</td>
                <td class="tb-col-4 text-center">
                    <button class="tb-btn tb-btn-auth">授权</button>
                    <button class="tb-btn tb-btn-edit">编辑区域</button>

                </td>
            </tr>
            </tbody>
        </table>
    </div>
    </div>
    </template>
</div>
<% endblock %>

<% block script %>
<script type="text/javascript">
    let page = new Vue({
      el: '#page',
      data: {
        list_region: JSON.parse(`<$ list_region | safe $>`),
      },
      methods: {
        getAgentClass: function(region){
          if (Array.isArray(this.list_region[region.id]) && this.list_region[region.id].length > 0){
            if (!region.is_open){
              return 'icon-triangle-right';
            }else{
              return 'icon-triangle-copy-copy-copy';
            }
          }
          return '';
        },
      }
    });
</script>
<% endblock %>
